<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SHS Enrollment System</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- FONTS -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- ICONS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
/* ============= GLOBAL VARIABLES ============= */
:root {
  --primary: #8B0000;
  --primary-light: #A52A2A;
  --secondary: #2D3748;
  --accent: #4299E1;
  --light: #F7FAFC;
  --white: #FFFFFF;
  --gray-100: #EDF2F7;
  --gray-200: #E2E8F0;
  --gray-300: #CBD5E0;
  --gray-700: #4A5568;
  --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
  --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.12);
  --radius: 12px;
  --radius-lg: 20px;
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', sans-serif;
  background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
  color: var(--secondary);
  line-height: 1.6;
  min-height: 100vh;
}

/* ============= HEADER ============= */
header {
  background: var(--white);
  padding: 1.25rem 2rem;
  border-bottom: 1px solid var(--gray-200);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.04);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1.5rem;
}

.logo-container {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.logo-badge {
  width: 60px;
  height: 60px;
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  border-radius: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
  font-size: 1.5rem;
  box-shadow: 0 6px 20px rgba(139, 0, 0, 0.2);
}

.header-content h1 {
  color: var(--primary);
  font-size: 1.75rem;
  font-weight: 700;
  font-family: 'Poppins', sans-serif;
  margin-bottom: 0.25rem;
  letter-spacing: -0.5px;
}

.header-content h3 {
  color: var(--gray-700);
  font-size: 0.95rem;
  font-weight: 500;
  opacity: 0.9;
}

.header-actions {
  display: flex;
  gap: 1rem;
}

/* ============= NAVIGATION ============= */
.nav-container {
  background: var(--white);
  padding: 0 2rem;
  border-bottom: 1px solid var(--gray-200);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.nav-tabs {
  display: flex;
  list-style: none;
}

.nav-tab {
  padding: 1rem 1.5rem;
  color: var(--gray-700);
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
  position: relative;
  border-bottom: 3px solid transparent;
}

.nav-tab:hover {
  color: var(--primary);
  background: var(--gray-100);
}

.nav-tab.active {
  color: var(--primary);
  border-bottom: 3px solid var(--primary);
  font-weight: 600;
}

.nav-tab i {
  margin-right: 0.5rem;
  font-size: 1.1rem;
}

/* ============= MAIN CONTAINER ============= */
.container {
  max-width: 1400px;
  margin: 2rem auto;
  padding: 0 2rem;
  display: grid;
  grid-template-columns: 1fr;
  gap: 2rem;
}

/* ============= SIDEBAR ============= */
.sidebar {
  display: none; /* Hidden by default on mobile */
}

@media (min-width: 1024px) {
  .container {
    grid-template-columns: 300px 1fr;
  }
  
  .sidebar {
    display: block;
    position: sticky;
    top: 2rem;
    height: fit-content;
  }
}

.progress-card {
  background: var(--white);
  border-radius: var(--radius-lg);
  padding: 2rem;
  box-shadow: var(--shadow);
  margin-bottom: 1.5rem;
}

.progress-card h3 {
  color: var(--primary);
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 1.5rem;
  font-family: 'Poppins', sans-serif;
}

.progress-bar {
  height: 8px;
  background: var(--gray-200);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 1rem;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--primary), var(--primary-light));
  border-radius: 4px;
  transition: width 0.3s ease;
}

.progress-steps {
  display: flex;
  justify-content: space-between;
  margin-top: 1rem;
}

.progress-step {
  text-align: center;
  font-size: 0.85rem;
  color: var(--gray-700);
}

.progress-step.active {
  color: var(--primary);
  font-weight: 600;
}

.progress-step.completed .step-number {
  background: var(--primary);
  color: white;
}

.step-number {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: var(--gray-200);
  color: var(--gray-700);
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 0.5rem;
  font-size: 0.85rem;
  font-weight: 600;
}

/* ============= STATS CARD ============= */
.stats-card {
  background: var(--white);
  border-radius: var(--radius-lg);
  padding: 2rem;
  box-shadow: var(--shadow);
}

.stats-card h3 {
  color: var(--primary);
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 1.5rem;
  font-family: 'Poppins', sans-serif;
}

.stat-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 0;
  border-bottom: 1px solid var(--gray-200);
}

.stat-item:last-child {
  border-bottom: none;
}

.stat-label {
  color: var(--gray-700);
  font-size: 0.95rem;
}

.stat-value {
  color: var(--primary);
  font-weight: 600;
  font-size: 1.1rem;
}

/* ============= PAGES ============= */
.page {
  display: none;
  background: var(--white);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  animation: slideUp 0.5s ease-out;
}

.page.active {
  display: block;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.page-header {
  padding: 2.5rem 2.5rem 1.5rem;
  border-bottom: 1px solid var(--gray-200);
}

.page-title {
  font-family: 'Poppins', sans-serif;
  font-size: 1.75rem;
  font-weight: 600;
  color: var(--primary);
  margin-bottom: 0.5rem;
}

.page-subtitle {
  color: var(--gray-700);
  font-size: 1rem;
}

.page-content {
  padding: 2.5rem;
}

/* ============= DASHBOARD PAGE ============= */
.dashboard-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.dashboard-card {
  background: var(--white);
  border-radius: var(--radius);
  padding: 1.5rem;
  box-shadow: var(--shadow);
  border-left: 4px solid var(--primary);
  transition: var(--transition);
}

.dashboard-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
}

.card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 1rem;
}

.card-icon {
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 1.25rem;
}

.card-stats h2 {
  font-size: 2rem;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 0.25rem;
}

.card-stats p {
  color: var(--gray-700);
  font-size: 0.9rem;
}

.card-trend {
  font-size: 0.85rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  margin-top: 0.5rem;
}

.trend-up {
  color: #28A745;
}

.trend-down {
  color: #DC3545;
}

/* ============= ENROLLMENT FORM ============= */
.section-title {
  font-family: 'Poppins', sans-serif;
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--primary);
  margin-bottom: 1.5rem;
  padding-bottom: 0.75rem;
  border-bottom: 3px solid var(--gray-200);
  position: relative;
}

.section-title::after {
  content: '';
  position: absolute;
  bottom: -3px;
  left: 0;
  width: 60px;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--primary-light));
}

/* TRACK SELECTION CARDS */
.track-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  margin: 2rem 0;
}

.track-card {
  background: var(--white);
  border-radius: var(--radius-lg);
  padding: 2.5rem;
  cursor: pointer;
  transition: var(--transition);
  border: 2px solid transparent;
  position: relative;
  overflow: hidden;
}

.track-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--primary), var(--primary-light));
}

.track-card:hover {
  transform: translateY(-8px);
  border-color: var(--primary);
  box-shadow: var(--shadow-lg);
}

.track-card h3 {
  color: var(--primary);
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 1rem;
  font-family: 'Poppins', sans-serif;
}

.track-card p {
  color: var(--gray-700);
  margin-bottom: 1.5rem;
  line-height: 1.7;
}

.strand-list {
  list-style: none;
  margin: 1.5rem 0;
}

.strand-list li {
  padding: 0.75rem 1rem;
  margin-bottom: 0.5rem;
  background: var(--gray-100);
  border-radius: var(--radius);
  display: flex;
  align-items: center;
  transition: var(--transition);
}

.strand-list li:hover {
  background: var(--primary);
  color: white;
  transform: translateX(5px);
}

.strand-list li::before {
  content: '‚úì';
  margin-right: 0.75rem;
  font-weight: bold;
  color: var(--primary);
}

.strand-list li:hover::before {
  color: white;
}

.select-btn {
  width: 100%;
  padding: 1rem;
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  color: white;
  border: none;
  border-radius: var(--radius);
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  transition: var(--transition);
  margin-top: 1rem;
}

.select-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(139, 0, 0, 0.3);
}

/* FORM STYLES */
.form-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.form-group {
  position: relative;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 500;
  color: var(--secondary);
  font-size: 0.9rem;
}

.form-group.required label::after {
  content: ' *';
  color: var(--primary);
  opacity: 0.8;
}

.form-group input:not([type="file"]),
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 0.875rem 1rem;
  border: 2px solid var(--gray-200);
  border-radius: var(--radius);
  font-family: 'Inter', sans-serif;
  font-size: 1rem;
  transition: var(--transition);
  background: var(--white);
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(139, 0, 0, 0.1);
}

.form-group input[readonly] {
  background: var(--gray-100);
  cursor: not-allowed;
}

.optional-note {
  font-size: 0.85rem;
  color: var(--gray-700);
  font-style: italic;
  margin-top: 0.25rem;
  display: block;
}

/* FILE UPLOAD STYLES */
.file-upload {
  position: relative;
  overflow: hidden;
  display: inline-block;
  width: 100%;
}

.file-upload input[type="file"] {
  position: absolute;
  left: 0;
  top: 0;
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}

.file-upload label {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 1.5rem;
  background: var(--gray-100);
  border: 2px dashed var(--gray-300);
  border-radius: var(--radius);
  cursor: pointer;
  transition: var(--transition);
  text-align: center;
  min-height: 120px;
  flex-direction: column;
  gap: 0.75rem;
}

.file-upload label:hover {
  border-color: var(--primary);
  background: var(--gray-200);
}

.file-upload label i {
  font-size: 2rem;
  color: var(--primary);
  margin-bottom: 0.5rem;
}

.file-upload label span {
  font-weight: 500;
  color: var(--secondary);
}

.file-name {
  margin-top: 0.5rem;
  font-size: 0.85rem;
  color: var(--gray-700);
  word-break: break-word;
}

/* TOGGLE BUTTON FOR GUARDIAN INFO */
.toggle-container {
  margin: 1rem 0;
}

.toggle-button {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1.5rem;
  background: var(--gray-100);
  border: 2px solid var(--gray-200);
  border-radius: var(--radius);
  cursor: pointer;
  transition: var(--transition);
  font-weight: 500;
  color: var(--secondary);
}

.toggle-button:hover {
  background: var(--gray-200);
  border-color: var(--primary-light);
}

.toggle-button.active {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

.toggle-button::before {
  content: '+';
  font-weight: bold;
  font-size: 1.2rem;
}

.toggle-button.active::before {
  content: '‚àí';
}

/* BUTTON STYLES */
.btn-row {
  display: flex;
  justify-content: space-between;
  margin-top: 3rem;
  padding-top: 2rem;
  border-top: 1px solid var(--gray-200);
}

.btn {
  padding: 0.875rem 2rem;
  border: none;
  border-radius: var(--radius);
  font-family: 'Poppins', sans-serif;
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  color: white;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(139, 0, 0, 0.3);
}

.btn-secondary {
  background: var(--white);
  color: var(--secondary);
  border: 2px solid var(--gray-300);
}

.btn-secondary:hover {
  border-color: var(--primary);
  color: var(--primary);
}

.btn-next::after {
  content: '‚Üí';
  margin-left: 0.25rem;
}

.btn-back::before {
  content: '‚Üê';
  margin-right: 0.25rem;
}

/* SEARCH BOX */
.search-box {
  display: flex;
  margin-bottom: 1.5rem;
  max-width: 400px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  border-radius: var(--radius);
  overflow: hidden;
}

.search-box input {
  flex: 1;
  padding: 0.875rem 1rem;
  border: 2px solid var(--gray-200);
  border-right: none;
  font-size: 1rem;
  background: var(--white);
  font-family: 'Inter', sans-serif;
}

.search-box button {
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  color: white;
  border: none;
  padding: 0 1.5rem;
  cursor: pointer;
  transition: var(--transition);
}

.search-box button:hover {
  background: var(--primary);
}

/* TABLE STYLES */
.table-container {
  background: var(--white);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
  margin-top: 1rem;
}

.data-table {
  width: 100%;
  border-collapse: collapse;
}

.data-table th {
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  color: white;
  padding: 1rem;
  text-align: left;
  font-weight: 600;
  font-size: 0.9rem;
}

.data-table td {
  padding: 1rem;
  border-bottom: 1px solid var(--gray-200);
  font-size: 0.9rem;
}

.data-table tr:hover {
  background: var(--gray-100);
}

/* STATUS BADGES */
.status-badge {
  display: inline-block;
  padding: 0.25rem 0.75rem;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 600;
}

.status-pending {
  background: rgba(255, 193, 7, 0.2);
  color: #856404;
}

.status-complete {
  background: rgba(40, 167, 69, 0.2);
  color: #155724;
}

.status-rejected {
  background: rgba(220, 53, 69, 0.2);
  color: #721c24;
}

/* MODAL STYLES */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 1rem;
  animation: fadeIn 0.3s ease;
}

.modal-content {
  background: var(--white);
  border-radius: var(--radius-lg);
  padding: 2rem;
  max-width: 500px;
  width: 100%;
  animation: slideUp 0.5s ease;
  max-height: 80vh;
  overflow-y: auto;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* RESPONSIVE DESIGN */
@media (max-width: 768px) {
  .container {
    padding: 0 1rem;
  }
  
  .page-content {
    padding: 1.5rem;
  }
  
  .track-grid {
    grid-template-columns: 1fr;
  }
  
  .form-grid {
    grid-template-columns: 1fr;
  }
  
  .dashboard-cards {
    grid-template-columns: 1fr;
  }
  
  .nav-tabs {
    overflow-x: auto;
    white-space: nowrap;
  }
  
  .btn-row {
    flex-direction: column;
    gap: 1rem;
  }
  
  .btn {
    width: 100%;
    justify-content: center;
  }
  
  header {
    flex-direction: column;
    text-align: center;
    gap: 1rem;
  }
  
  .header-actions {
    width: 100%;
    justify-content: center;
  }
}

/* UTILITY CLASSES */
.text-center { text-align: center; }
.mb-1 { margin-bottom: 1rem; }
.mb-2 { margin-bottom: 2rem; }
.mt-1 { margin-top: 1rem; }
.mt-2 { margin-top: 2rem; }
.hidden { display: none !important; }
/* Add to the CSS section */
.success-message {
  animation: slideDown 0.5s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
/* ============= CHART STYLES ============= */
.chart-card {
  transition: var(--transition);
}

.chart-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-lg);
}

.chart-legend {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 1rem;
  margin-top: 1rem;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
  color: var(--gray-700);
}

.legend-color {
  width: 12px;
  height: 12px;
  border-radius: 3px;
}

/* Add responsive design for charts */
@media (max-width: 768px) {
  .charts-container {
    grid-template-columns: 1fr !important;
  }
  
  .chart-card {
    margin-bottom: 1rem;
  }
}
/* Add to CSS section */
.logo-badge img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  border-radius: 16px;
  transition: var(--transition);
}

.logo-badge:hover img {
  transform: scale(1.05);
}
</style>
</head>
<body>

<!-- ============= HEADER ============= -->
<header>
 <div class="logo-container">
    <div class="logo-badge">
    
      <img src="jedel.jpg" 
           alt="M.O.R.M.S. Logo" 
           style="width: 100%; height: 100%; object-fit: cover; border-radius: 16px;">
    </div>
    <div class="header-content">
      <h1>Senior High School Enrollment System</h1>
      <h3>MORMS - Complete Student Management Portal</h3>
    </div>
  </div>
  <div class="header-actions">
    <button class="btn btn-secondary" onclick="openDashboard()">
      <i class="fas fa-tachometer-alt"></i> Dashboard
    </button>
    <button class="btn btn-primary" onclick="openNewEnrollment()">
      <i class="fas fa-user-plus"></i> New Enrollment
    </button>
  </div>
</header>

<!-- ============= NAVIGATION ============= -->
<nav class="nav-container">
  <ul class="nav-tabs">
    <li class="nav-tab active" onclick="openPage('dashboard', this)">
      <i class="fas fa-tachometer-alt"></i> Dashboard
    </li>
    <li class="nav-tab" onclick="openPage('enrollment', this)">
      <i class="fas fa-user-plus"></i> Enrollment
    </li>
    <li class="nav-tab" onclick="openPage('students', this)">
      <i class="fas fa-users"></i> Student List
    </li>
    <li class="nav-tab" onclick="openPage('documents', this)">
      <i class="fas fa-file-alt"></i> Documents
    </li>
    <li class="nav-tab" onclick="openPage('reports', this)">
      <i class="fas fa-chart-bar"></i> Reports
    </li>
  </ul>
</nav>

<!-- ============= MAIN CONTAINER ============= -->
<div class="container">
  
  <!-- ============= SIDEBAR ============= -->
  <div class="sidebar">
    <div class="progress-card">
      <h3>Enrollment Progress</h3>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width: 33%"></div>
      </div>
      <div class="progress-steps">
        <div class="progress-step active">
          <div class="step-number">1</div>
          <span>Track</span>
        </div>
        <div class="progress-step">
          <div class="step-number">2</div>
          <span>Student Info</span>
        </div>
        <div class="progress-step">
          <div class="step-number">3</div>
          <span>Documents</span>
        </div>
      </div>
    </div>
    
    <div class="stats-card">
      <h3>Quick Stats</h3>
      <div class="stat-item">
        <span class="stat-label">Today's Enrollments</span>
        <span class="stat-value" id="todayEnrollments">12</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Pending Documents</span>
        <span class="stat-value" id="pendingDocs">8</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Total Students</span>
        <span class="stat-value" id="totalStudents">1,245</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Completion Rate</span>
        <span class="stat-value" id="completionRate">94%</span>
      </div>
    </div>
  </div>

  <!-- ============= MAIN CONTENT ============= -->
  <div class="main-content">
    
    <!-- ============= DASHBOARD PAGE ============= -->
  
        <!-- ============= DASHBOARD PAGE ============= -->
<div id="dashboard" class="page active">
  <div class="page-header">
    <h1 class="page-title"><i class="fas fa-tachometer-alt"></i> Dashboard Overview</h1>
    <p class="page-subtitle">Welcome to the Senior High School Enrollment Management System</p>
  </div>
  <div class="page-content">
    
    <!-- Quick Stats Cards -->
    <div class="dashboard-cards">
      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-icon">
            <i class="fas fa-users"></i>
          </div>
        </div>
        <div class="card-stats">
          <h2 id="totalStudentsCard">1,245</h2>
          <p>Total Students</p>
          <div class="card-trend trend-up">
            <i class="fas fa-arrow-up"></i> 5.2% from last month
          </div>
        </div>
      </div>
      
      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-icon">
            <i class="fas fa-user-plus"></i>
          </div>
        </div>
        <div class="card-stats">
          <h2 id="todayEnrollmentsCard">12</h2>
          <p>Enrolled Today</p>
          <div class="card-trend trend-up">
            <i class="fas fa-arrow-up"></i> 12.5% from yesterday
          </div>
        </div>
      </div>
      
      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-icon">
            <i class="fas fa-file-alt"></i>
          </div>
        </div>
        <div class="card-stats">
          <h2 id="pendingDocsCard">8</h2>
          <p>Pending Documents</p>
          <div class="card-trend trend-down">
            <i class="fas fa-arrow-down"></i> 3.7% from last week
          </div>
        </div>
      </div>
      
      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-icon">
            <i class="fas fa-chart-line"></i>
          </div>
        </div>
        <div class="card-stats">
          <h2 id="completionRateCard">94%</h2>
          <p>Completion Rate</p>
          <div class="card-trend trend-up">
            <i class="fas fa-arrow-up"></i> 2.1% from last quarter
          </div>
        </div>
      </div>
    </div>
    
    <!-- Analytics Section with Pie Charts -->
    <div class="analytics-section" style="margin: 2rem 0;">
      <h3 class="section-title">Enrollment Analytics</h3>
      
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
        <!-- Track Distribution Pie Chart -->
        <div class="chart-card" style="background: var(--white); border-radius: var(--radius-lg); padding: 1.5rem; box-shadow: var(--shadow);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
            <h4 style="color: var(--primary); font-family: 'Poppins', sans-serif; font-size: 1.1rem;">
              <i class="fas fa-graduation-cap"></i> Track Distribution
            </h4>
            <div style="display: flex; gap: 0.5rem; font-size: 0.85rem;">
              <span style="color: var(--primary);"><i class="fas fa-circle" style="color: #8B0000;"></i> Academic</span>
              <span style="color: var(--primary);"><i class="fas fa-circle" style="color: #006400;"></i> Tech-Pro</span>
            </div>
          </div>
          <div style="position: relative; height: 250px;">
            <canvas id="dashboardTrackChart"></canvas>
          </div>
          <div id="trackSummary" style="margin-top: 1rem; text-align: center; font-size: 0.9rem; color: var(--gray-700);"></div>
        </div>
        
        <!-- Gender Distribution Pie Chart -->
        <div class="chart-card" style="background: var(--white); border-radius: var(--radius-lg); padding: 1.5rem; box-shadow: var(--shadow);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
            <h4 style="color: var(--primary); font-family: 'Poppins', sans-serif; font-size: 1.1rem;">
              <i class="fas fa-user-friends"></i> Gender Distribution
            </h4>
            <div style="display: flex; gap: 0.5rem; font-size: 0.85rem;">
              <span style="color: var(--primary);"><i class="fas fa-circle" style="color: #36a2eb;"></i> Male</span>
              <span style="color: var(--primary);"><i class="fas fa-circle" style="color: #ff6384;"></i> Female</span>
            </div>
          </div>
          <div style="position: relative; height: 250px;">
            <canvas id="dashboardGenderChart"></canvas>
          </div>
          <div id="genderSummary" style="margin-top: 1rem; text-align: center; font-size: 0.9rem; color: var(--gray-700);"></div>
        </div>
      </div>
    </div>
    
    <!-- Search and Recent Enrollments -->
    <div class="search-box">
      <input type="text" id="dashboardSearch" placeholder="Search enrollments, students, or reports...">
      <button onclick="searchDashboard()">
        <i class="fas fa-search"></i>
      </button>
    </div>
    
    <h3 class="section-title">Recent Enrollments</h3>
    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th>LRN</th>
            <th>Name</th>
            <th>Track</th>
            <th>Strand</th>
            <th>Status</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody id="recentEnrollments">
          <!-- Recent enrollments will be loaded here -->
        </tbody>
      </table>
    </div>
  </div>
</div>
        
    

    <!-- ============= ENROLLMENT PAGE ============= -->
    <div id="enrollment" class="page">
      <div class="page-header">
        <h1 class="page-title"><i class="fas fa-user-plus"></i> New Student Enrollment</h1>
        <p class="page-subtitle">Complete the following steps to enroll a new student</p>
      </div>
      <div class="page-content">
        
        <!-- Step 1: Track Selection -->
        <div id="step1">
          <h2 class="section-title">Step 1: Choose Your Track</h2>
          
          <div class="track-grid">
            <div class="track-card" onclick="selectTrack('Academic')">
              <h3>Academic Track</h3>
              <p>Prepares you for college and professional careers with specialized strands that focus on academic excellence and critical thinking.</p>
              <strong>Available Strands:</strong>
              <ul class="strand-list">
                <li>STEM (Science, Technology, Engineering & Mathematics)</li>
                <li>ABM (Accountancy, Business & Management)</li>
                <li>HUMSS (Humanities & Social Sciences)</li>
              </ul>
              <button class="select-btn" onclick="selectTrack('Academic')">
                <span>Select Academic Track</span>
              </button>
            </div>

            <div class="track-card" onclick="selectTrack('Tech-Pro')">
              <h3>Tech-Pro Track</h3>
              <p>Skill-based preparation for immediate employment or entrepreneurship with hands-on training in technical fields.</p>
              <strong>Available Strands:</strong>
              <ul class="strand-list">
                <li>ICT (Information & Communications Technology)</li>
                <li>Home Economics</li>
                <li>Automotive Technology</li>
              </ul>
              <button class="select-btn" onclick="selectTrack('Tech-Pro')">
                <span>Select Tech-Pro Track</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Step 2: Student Information -->
        <div id="step2" class="hidden">
          <h2 class="section-title">Step 2: Student Information</h2>
          
          <div class="form-grid">
            <div class="form-group required">
              <label>LRN (Learner Reference Number)</label>
              <input type="text" id="lrn" placeholder="Enter 12-digit LRN" required>
            </div>
          </div>

          <h3 class="section-title mt-2">Personal Details</h3>
          <div class="form-grid">
            <div class="form-group required">
              <label>Last Name</label>
              <input type="text" id="lastname" required>
            </div>
            <div class="form-group required">
              <label>First Name</label>
              <input type="text" id="firstname" required>
            </div>
            <div class="form-group required">
              <label>Middle Name</label>
              <input type="text" id="middlename" required>
            </div>
            <div class="form-group required">
              <label>Sex</label>
              <select id="sex" required>
                <option value="">Select</option>
                <option>Male</option>
                <option>Female</option>
              </select>
            </div>
            <div class="form-group required">
              <label>Age</label>
              <input type="number" id="age" min="15" max="25" required>
            </div>
            <div class="form-group required">
              <label>Date of Birth</label>
              <input type="date" id="dob" required>
            </div>
            <div class="form-group required">
              <label>Place of Birth</label>
              <input type="text" id="placebirth" required>
            </div>
            <div class="form-group required">
              <label>Mother Tongue</label>
              <input type="text" id="mothertongue" required>
            </div>
          </div>

          <h3 class="section-title mt-2">Address Information</h3>
          <div class="form-grid">
            <div class="form-group required">
              <label>Current Address</label>
              <input type="text" id="currentaddress" required>
            </div>
            <div class="form-group required">
              <label>Permanent Address</label>
              <input type="text" id="permanentaddress" required>
            </div>
          </div>

          <h3 class="section-title mt-2">Parent Information</h3>
          <div class="form-grid">
            <div class="form-group required">
              <label>Father's Full Name</label>
              <input type="text" id="fathername" required>
            </div>
            <div class="form-group required">
              <label>Father's Contact Number</label>
              <input type="tel" id="fathercontact" required>
            </div>
            <div class="form-group required">
              <label>Mother's Full Name</label>
              <input type="text" id="mothername" required>
            </div>
            <div class="form-group required">
              <label>Mother's Contact Number</label>
              <input type="tel" id="mothercontact" required>
            </div>
          </div>

          <h3 class="section-title mt-2">Guardian Information <small style="font-size: 1rem; color: var(--gray-700); font-weight: normal;">(Optional)</small></h3>
          
          <div class="toggle-container">
            <div class="toggle-button" onclick="toggleGuardianInfo()">
              Add Guardian Information
            </div>
          </div>
          
          <div id="guardianInfoSection" style="display: none;">
            <div class="form-grid">
              <div class="form-group">
                <label>Guardian's Full Name</label>
                <input type="text" id="guardianname" placeholder="Enter guardian's full name">
                <span class="optional-note">Optional</span>
              </div>
              <div class="form-group">
                <label>Relationship to Student</label>
                <select id="guardianrelationship">
                  <option value="">Select relationship</option>
                  <option>Grandparent</option>
                  <option>Uncle/Aunt</option>
                  <option>Sibling</option>
                  <option>Other Relative</option>
                  <option>Family Friend</option>
                  <option>Legal Guardian</option>
                </select>
                <span class="optional-note">Optional</span>
              </div>
              <div class="form-group">
                <label>Guardian's Contact Number</label>
                <input type="tel" id="guardiancontact" placeholder="Enter contact number">
                <span class="optional-note">Optional</span>
              </div>
            </div>
          </div>

          <h3 class="section-title mt-2">School Information</h3>
          <div class="form-grid">
            <div class="form-group required">
              <label>School Year</label>
              <input type="text" id="schoolyear" placeholder="e.g. 2025‚Äì2026" required>
            </div>
            <div class="form-group required">
              <label>Grade Level to Enroll</label>
              <select id="gradelevel" required>
                <option value="">Select</option>
                <option>Grade 11</option>
                <option>Grade 12</option>
              </select>
            </div>
            <div class="form-group required">
              <label>Last Grade Level Completed</label>
              <input type="text" id="lastgrade" required>
            </div>
            <div class="form-group required">
              <label>Last School Year Completed</label>
              <input type="text" id="lastschoolyear" required>
            </div>
            <div class="form-group required">
              <label>Selected Track</label>
              <input type="text" id="trackInput" readonly required>
            </div>
            <div class="form-group required">
              <label>Strand</label>
              <select id="strandSelect" required>
                <option value="">Select Strand</option>
              </select>
            </div>
          </div>

          <div class="btn-row">
            <button class="btn btn-secondary btn-back" onclick="goToStep(1)">
              <i class="fas fa-arrow-left"></i> Back to Track Selection
            </button>
            <button class="btn btn-primary btn-next" onclick="validateStep2()">
              Continue to Documents <i class="fas fa-arrow-right"></i>
            </button>
          </div>
        </div>

        <!-- Step 3: Document Upload -->
        <div id="step3" class="hidden">
          <h2 class="section-title">Step 3: Upload Required Documents</h2>
          <p class="mb-2" style="color: var(--gray-700);">Please upload clear scans/photos of the following documents (PDF, JPG, or PNG format)</p>
          
          <div class="form-grid">
            <div class="form-group">
              <div class="file-upload">
                <input type="file" id="form138" accept=".pdf,.jpg,.jpeg,.png" required>
                <label for="form138">
                  <div style="font-size: 2rem; color: var(--primary);">üìÑ</div>
                  <span>Form 138 / Report Card</span>
                  <small>Click to upload or drag and drop</small>
                </label>
                <div class="file-name" id="form138-name"></div>
              </div>
            </div>
            
            <div class="form-group">
              <div class="file-upload">
                <input type="file" id="birthCertificate" accept=".pdf,.jpg,.jpeg,.png" required>
                <label for="birthCertificate">
                  <div style="font-size: 2rem; color: var(--primary);">üìã</div>
                  <span>PSA Birth Certificate</span>
                  <small>Click to upload or drag and drop</small>
                </label>
                <div class="file-name" id="birthCertificate-name"></div>
              </div>
            </div>
            
            <div class="form-group">
              <div class="file-upload">
                <input type="file" id="goodMoral" accept=".pdf,.jpg,.jpeg,.png" required>
                <label for="goodMoral">
                  <div style="font-size: 2rem; color: var(--primary);">üìú</div>
                  <span>Good Moral Certificate</span>
                  <small>Click to upload or drag and drop</small>
                </label>
                <div class="file-name" id="goodMoral-name"></div>
              </div>
            </div>
            
            <div class="form-group">
              <div class="file-upload">
                <input type="file" id="transferCert" accept=".pdf,.jpg,.jpeg,.png">
                <label for="transferCert">
                  <div style="font-size: 2rem; color: var(--primary);">üìë</div>
                  <span>Certificate of Transfer</span>
                  <small>If applicable</small>
                </label>
                <div class="file-name" id="transferCert-name"></div>
              </div>
            </div>
            
            <div class="form-group">
              <div class="file-upload">
                <input type="file" id="idPicture" accept=".jpg,.jpeg,.png" required>
                <label for="idPicture">
                  <div style="font-size: 2rem; color: var(--primary);">üì∑</div>
                  <span>2x2 ID Picture</span>
                  <small>White background, recent photo</small>
                </label>
                <div class="file-name" id="idPicture-name"></div>
              </div>
            </div>
          </div>

          <div class="btn-row">
            <button class="btn btn-secondary btn-back" onclick="goToStep(2)">
              <i class="fas fa-arrow-left"></i> Back to Student Info
            </button>
            <button class="btn btn-primary" onclick="submitEnrollment()">
              <i class="fas fa-check"></i> Submit Enrollment
            </button>
          </div>
        </div>

      </div>
    </div>

    <!-- ============= STUDENT LIST PAGE ============= -->
    <div id="students" class="page">
      <div class="page-header">
        <h1 class="page-title"><i class="fas fa-users"></i> Student List</h1>
        <p class="page-subtitle">View and manage all enrolled students</p>
      </div>
      <div class="page-content">
        <div class="search-box">
          <input type="text" id="studentSearch" placeholder="Search by LRN, name, track, or strand..." onkeyup="searchStudents()">
          <button onclick="searchStudents()">
            <i class="fas fa-search"></i>
          </button>
        </div>
        
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>LRN</th>
                <th>Name</th>
                <th>Track</th>
                <th>Strand</th>
                <th>Grade Level</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="studentList">
              <!-- Student list will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ============= DOCUMENTS PAGE ============= -->
    <div id="documents" class="page">
      <div class="page-header">
        <h1 class="page-title"><i class="fas fa-file-alt"></i> Document Management</h1>
        <p class="page-subtitle">View and manage student documents</p>
      </div>
      <div class="page-content">
        <div class="dashboard-cards">
          <div class="dashboard-card">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-file-pdf"></i>
              </div>
            </div>
            <div class="card-stats">
              <h2 id="pendingReview">8</h2>
              <p>Pending Review</p>
            </div>
          </div>
          
          <div class="dashboard-card">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-file-check"></i>
              </div>
            </div>
            <div class="card-stats">
              <h2 id="approvedDocs">142</h2>
              <p>Approved</p>
            </div>
          </div>
          
          <div class="dashboard-card">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-file-excel"></i>
              </div>
            </div>
            <div class="card-stats">
              <h2 id="processedDocs">1,084</h2>
              <p>Processed</p>
            </div>
          </div>
        </div>
        
        <h3 class="section-title">Recent Document Submissions</h3>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Student</th>
                <th>Document Type</th>
                <th>Date Submitted</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="documentList">
              <!-- Document list will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ============= REPORTS PAGE ============= -->
    <div id="reports" class="page">
      <div class="page-header">
        <h1 class="page-title"><i class="fas fa-chart-bar"></i> Reports & Analytics</h1>
        <p class="page-subtitle">Generate and view enrollment reports</p>
      </div>
      <div class="page-content">
        <div class="dashboard-cards">
          <div class="dashboard-card" onclick="generateReport()" style="cursor: pointer;">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-file-export"></i>
              </div>
            </div>
            <div class="card-stats">
              <h2>Generate</h2>
              <p>Create custom reports</p>
            </div>
          </div>
          
          <div class="dashboard-card" onclick="viewReportHistory()" style="cursor: pointer;">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-history"></i>
              </div>
            </div>
            <div class="card-stats">
              <h2>History</h2>
              <p>View past reports</p>
            </div>
          </div>
          
          <div class="dashboard-card" onclick="configureReports()" style="cursor: pointer;">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-cog"></i>
              </div>
            </div>
            <div class="card-stats">
              <h2>Configure</h2>
              <p>Report settings</p>
            </div>
          </div>
        </div>
        
        <h3 class="section-title">Enrollment Statistics</h3>
        <div class="form-grid">
          <div class="form-group">
            <label>Report Type</label>
            <select id="reportType">
              <option>Track Distribution</option>
              <option>Strand Distribution</option>
              <option>Gender Distribution</option>
              <option>Grade Level Distribution</option>
              <option>Monthly Enrollment Trend</option>
            </select>
          </div>
          <div class="form-group">
            <label>School Year</label>
            <select id="reportYear">
              <option>2024-2025</option>
              <option>2023-2024</option>
              <option>2022-2023</option>
              <option>2021-2022</option>
            </select>
          </div>
          <div class="form-group">
            <label>Format</label>
            <select id="reportFormat">
              <option>PDF</option>
              <option>Excel</option>
              <option>CSV</option>
              <option>Print</option>
            </select>
          </div>
        </div>
        
        <div class="btn-row">
          <button class="btn btn-secondary" onclick="clearReportFilters()">
            <i class="fas fa-times"></i> Clear Filters
          </button>
          <button class="btn btn-primary" onclick="generateReport()">
            <i class="fas fa-download"></i> Generate Report
          </button>
        </div>
      </div>
    </div>

  </div>
</div>
<!-- ============= REPORTS PAGE ============= -->
<div id="reports" class="page">
  <div class="page-header">
    <h1 class="page-title"><i class="fas fa-chart-bar"></i> Reports & Analytics</h1>
    <p class="page-subtitle">Generate and view enrollment reports and statistics</p>
  </div>
  <div class="page-content">
    
    <!-- Analytics Dashboard -->
    <div class="analytics-section mb-2">
      <h3 class="section-title">Enrollment Analytics</h3>
      
      <div class="dashboard-cards">
        <div class="dashboard-card" style="cursor: default;">
          <div class="card-header">
            <div class="card-icon">
              <i class="fas fa-chart-pie"></i>
            </div>
          </div>
          <div class="card-stats">
            <h2 id="academicCount">0</h2>
            <p>Academic Track</p>
          </div>
        </div>
        
        <div class="dashboard-card" style="cursor: default;">
          <div class="card-header">
            <div class="card-icon">
              <i class="fas fa-chart-pie"></i>
            </div>
          </div>
          <div class="card-stats">
            <h2 id="techproCount">0</h2>
            <p>Tech-Pro Track</p>
          </div>
        </div>
        
        <div class="dashboard-card" style="cursor: default;">
          <div class="card-header">
            <div class="card-icon">
              <i class="fas fa-male"></i>
            </div>
          </div>
          <div class="card-stats">
            <h2 id="maleCount">0</h2>
            <p>Male Students</p>
          </div>
        </div>
        
        <div class="dashboard-card" style="cursor: default;">
          <div class="card-header">
            <div class="card-icon">
              <i class="fas fa-female"></i>
            </div>
          </div>
          <div class="card-stats">
            <h2 id="femaleCount">0</h2>
            <p>Female Students</p>
          </div>
        </div>
      </div>
      
      <!-- Charts Container -->
      <div class="charts-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; margin-top: 2rem;">
        <div class="chart-card" style="background: var(--white); border-radius: var(--radius-lg); padding: 1.5rem; box-shadow: var(--shadow);">
          <h4 style="color: var(--primary); margin-bottom: 1rem; font-family: 'Poppins', sans-serif;">
            <i class="fas fa-graduation-cap"></i> Track Distribution
          </h4>
          <div style="position: relative; height: 300px;">
            <canvas id="trackChart"></canvas>
          </div>
          <div id="trackLegend" style="display: flex; justify-content: center; margin-top: 1rem; gap: 1rem;"></div>
        </div>
        
        <div class="chart-card" style="background: var(--white); border-radius: var(--radius-lg); padding: 1.5rem; box-shadow: var(--shadow);">
          <h4 style="color: var(--primary); margin-bottom: 1rem; font-family: 'Poppins', sans-serif;">
            <i class="fas fa-user-friends"></i> Gender Distribution
          </h4>
          <div style="position: relative; height: 300px;">
            <canvas id="genderChart"></canvas>
          </div>
          <div id="genderLegend" style="display: flex; justify-content: center; margin-top: 1rem; gap: 1rem;"></div>
        </div>
      </div>
      
      <!-- Additional Analytics -->
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 2rem;">
        <div class="chart-card" style="background: var(--white); border-radius: var(--radius-lg); padding: 1.5rem; box-shadow: var(--shadow);">
          <h4 style="color: var(--primary); margin-bottom: 1rem; font-family: 'Poppins', sans-serif;">
            <i class="fas fa-stream"></i> Strand Distribution
          </h4>
          <div style="position: relative; height: 250px;">
            <canvas id="strandChart"></canvas>
          </div>
        </div>
        
        <div class="chart-card" style="background: var(--white); border-radius: var(--radius-lg); padding: 1.5rem; box-shadow: var(--shadow);">
          <h4 style="color: var(--primary); margin-bottom: 1rem; font-family: 'Poppins', sans-serif;">
            <i class="fas fa-calendar-alt"></i> Enrollment Trend
          </h4>
          <div style="position: relative; height: 250px;">
            <canvas id="trendChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- Report Generation Section -->
    <h3 class="section-title">Generate Reports</h3>
    <div class="form-grid">
      <div class="form-group">
        <label>Report Type</label>
        <select id="reportType">
          <option>Track Distribution</option>
          <option>Strand Distribution</option>
          <option>Gender Distribution</option>
          <option>Grade Level Distribution</option>
          <option>Monthly Enrollment Trend</option>
          <option>Comprehensive Analytics</option>
        </select>
      </div>
      <div class="form-group">
        <label>School Year</label>
        <select id="reportYear">
          <option>2024-2025</option>
          <option>2023-2024</option>
          <option>2022-2023</option>
          <option>2021-2022</option>
        </select>
      </div>
      <div class="form-group">
        <label>Format</label>
        <select id="reportFormat">
          <option>PDF</option>
          <option>Excel</option>
          <option>CSV</option>
          <option>Print</option>
        </select>
      </div>
    </div>
    
    <div class="btn-row">
      <button class="btn btn-secondary" onclick="refreshCharts()">
        <i class="fas fa-sync-alt"></i> Refresh Analytics
      </button>
      <button class="btn btn-primary" onclick="generateReport()">
        <i class="fas fa-download"></i> Generate Report
      </button>
    </div>
    
  </div>
</div>

<script>
// ============= GLOBAL VARIABLES =============
let currentPage = 'dashboard';
let currentStep = 1;
let selectedTrack = '';
let guardianInfoVisible = false;
let students = [];
let documents = [];

// Chart instances
let trackChart, genderChart, strandChart, trendChart;
let dashboardTrackChart, dashboardGenderChart; // Add these for dashboard

// ============= INITIALIZATION =============
document.addEventListener('DOMContentLoaded', function() {
  loadSampleData();
  updateProgress();
  setupFileUploads();
  updateStats();
  loadRecentEnrollments();
  loadStudentList();
  loadDocumentList();
  
  // Initialize charts when reports page is loaded
  setTimeout(initializeCharts, 500);
  
  // Initialize dashboard charts
  setTimeout(initializeDashboardCharts, 600);
});

// ============= PAGE NAVIGATION =============
function openPage(pageId, element) {
  // Update active tab
  document.querySelectorAll('.nav-tab').forEach(tab => {
    tab.classList.remove('active');
  });
  element.classList.add('active');
  
  // Hide all pages
  document.querySelectorAll('.page').forEach(page => {
    page.classList.remove('active');
  });
  
  // Show selected page
  document.getElementById(pageId).classList.add('active');
  currentPage = pageId;
  
  // Update page-specific content
  if (pageId === 'dashboard') {
    updateStats();
    loadRecentEnrollments();
    // Initialize or update dashboard charts when dashboard is opened
    setTimeout(() => {
      updateDashboardCharts();
    }, 100);
  } else if (pageId === 'students') {
    loadStudentList();
  } else if (pageId === 'documents') {
    loadDocumentList();
  } else if (pageId === 'reports') {
    // Initialize or update charts when reports page is opened
    setTimeout(() => {
      updateAnalytics();
      initializeCharts();
    }, 100);
  }
}

function openDashboard() {
  openPage('dashboard', document.querySelector('.nav-tab'));
}

function openNewEnrollment() {
  openPage('enrollment', document.querySelectorAll('.nav-tab')[1]);
  resetEnrollmentForm();
}

// ============= ENROLLMENT FORM FUNCTIONS =============
function selectTrack(track) {
  selectedTrack = track;
  document.getElementById('trackInput').value = track;
  
  const strandSelect = document.getElementById('strandSelect');
  strandSelect.innerHTML = '<option value="">Select Strand</option>';
  
  const strands = track === 'Academic' 
    ? ['STEM', 'ABM', 'HUMSS']
    : ['ICT', 'Home Economics', 'Automotive'];
  
  strands.forEach(strand => {
    const option = document.createElement('option');
    option.value = strand;
    option.textContent = strand;
    strandSelect.appendChild(option);
  });
  
  goToStep(2);
}

function goToStep(step) {
  // Hide all steps
  document.getElementById('step1').classList.add('hidden');
  document.getElementById('step2').classList.add('hidden');
  document.getElementById('step3').classList.add('hidden');
  
  // Show selected step
  document.getElementById(`step${step}`).classList.remove('hidden');
  currentStep = step;
  
  // Update progress bar
  updateProgress();
  
  // Scroll to top of step
  document.getElementById(`step${step}`).scrollIntoView({ behavior: 'smooth' });
}

function updateProgress() {
  const progress = (currentStep - 1) / 2;
  document.getElementById('progressFill').style.width = `${progress * 100}%`;
  
  // Update step indicators
  const steps = document.querySelectorAll('.progress-step');
  steps.forEach((step, index) => {
    const stepNumber = index + 1;
    step.classList.remove('active', 'completed');
    
    if (stepNumber === currentStep) {
      step.classList.add('active');
    } else if (stepNumber < currentStep) {
      step.classList.add('completed');
    }
  });
}

function toggleGuardianInfo() {
  guardianInfoVisible = !guardianInfoVisible;
  const section = document.getElementById('guardianInfoSection');
  const button = document.querySelector('.toggle-button');
  
  if (guardianInfoVisible) {
    section.style.display = 'block';
    button.classList.add('active');
    button.innerHTML = 'Remove Guardian Information';
  } else {
    section.style.display = 'none';
    button.classList.remove('active');
    button.innerHTML = 'Add Guardian Information';
  }
}

function validateStep2() {
  const requiredInputs = document.querySelectorAll('#step2 .required input[required], #step2 .required select[required]');
  let isValid = true;
  
  requiredInputs.forEach(input => {
    if (!input.value.trim()) {
      input.style.borderColor = 'var(--primary)';
      input.style.boxShadow = '0 0 0 3px rgba(139, 0, 0, 0.2)';
      isValid = false;
    } else {
      input.style.borderColor = '';
      input.style.boxShadow = '';
    }
  });
  
  if (!isValid) {
    alert('Please fill in all required fields before proceeding.');
    return;
  }
  
  // Validate LRN (12 digits)
  const lrn = document.getElementById('lrn').value;
  if (!/^\d{12}$/.test(lrn)) {
    alert('Please enter a valid 12-digit LRN.');
    document.getElementById('lrn').focus();
    return;
  }
  
  // Check if LRN already exists
  if (students.some(s => s.lrn === lrn)) {
    alert('A student with this LRN already exists!');
    return;
  }
  
  goToStep(3);
}

function submitEnrollment() {
  // Validate required files
  const requiredFiles = document.querySelectorAll('#step3 input[required]');
  let hasAllFiles = true;
  
  requiredFiles.forEach(input => {
    if (!input.files.length) {
      const label = input.nextElementSibling;
      label.style.borderColor = 'var(--primary)';
      label.style.background = 'rgba(139, 0, 0, 0.05)';
      hasAllFiles = false;
    }
  });
  
  if (!hasAllFiles) {
    alert('Please upload all required documents before submitting.');
    return;
  }
  
  // Collect form data
  const formData = collectFormData();
  
  // Add to students array
  students.push(formData);
  
  // Show success modal
  showSuccessModal(formData);
  
  // Reset form
  resetEnrollmentForm();
  
  // Update all relevant sections
  updateStats();
  loadRecentEnrollments();
  loadStudentList();
  
  // Refresh analytics and charts
  updateAnalytics();
  if (currentPage === 'reports') {
    initializeCharts();
  }
  
  // Update dashboard charts if on dashboard
  if (currentPage === 'dashboard') {
    updateDashboardCharts();
  }
  
  // If we're on the enrollment page, show a confirmation that student was added
  if (currentPage === 'enrollment') {
    const enrollmentPage = document.getElementById('enrollment');
    const successMessage = document.createElement('div');
    successMessage.className = 'success-message';
    successMessage.innerHTML = `
      <div style="background: rgba(40, 167, 69, 0.1); padding: 1rem; border-radius: var(--radius); margin-top: 1rem; border-left: 4px solid #28a745;">
        <div style="display: flex; align-items: center; gap: 0.5rem; color: #155724;">
          <i class="fas fa-check-circle"></i>
          <strong>Student enrolled successfully!</strong> ${formData.firstName} ${formData.lastName} has been added to the student list.
        </div>
        <div style="margin-top: 0.5rem; font-size: 0.9rem; color: #155724;">
          LRN: ${formData.lrn} | Track: ${formData.track} | Strand: ${formData.strand}
        </div>
        <button onclick="openPage('students', document.querySelectorAll('.nav-tab')[2])" 
          style="margin-top: 0.75rem; padding: 0.5rem 1rem; background: #28a745; color: white; border: none; border-radius: var(--radius); cursor: pointer; display: flex; align-items: center; gap: 0.5rem;">
          <i class="fas fa-users"></i> View Student List
        </button>
      </div>
    `;
    
    // Remove any existing success message
    const existingMessage = enrollmentPage.querySelector('.success-message');
    if (existingMessage) existingMessage.remove();
    
    // Insert after the enrollment form
    const pageContent = enrollmentPage.querySelector('.page-content');
    pageContent.insertBefore(successMessage, pageContent.firstChild);
    
    // Auto-remove after 10 seconds
    setTimeout(() => {
      if (successMessage.parentNode) successMessage.remove();
    }, 10000);
  }
}

function collectFormData() {
  return {
    id: Date.now(), // Unique ID
    lrn: document.getElementById('lrn').value,
    lastName: document.getElementById('lastname').value,
    firstName: document.getElementById('firstname').value,
    middleName: document.getElementById('middlename').value,
    sex: document.getElementById('sex').value,
    age: document.getElementById('age').value,
    dob: document.getElementById('dob').value,
    placeOfBirth: document.getElementById('placebirth').value,
    motherTongue: document.getElementById('mothertongue').value,
    currentAddress: document.getElementById('currentaddress').value,
    permanentAddress: document.getElementById('permanentaddress').value,
    fatherName: document.getElementById('fathername').value,
    fatherContact: document.getElementById('fathercontact').value,
    motherName: document.getElementById('mothername').value,
    motherContact: document.getElementById('mothercontact').value,
    guardianName: document.getElementById('guardianname')?.value || '',
    guardianRelationship: document.getElementById('guardianrelationship')?.value || '',
    guardianContact: document.getElementById('guardiancontact')?.value || '',
    schoolYear: document.getElementById('schoolyear').value,
    gradeLevel: document.getElementById('gradelevel').value,
    lastGradeCompleted: document.getElementById('lastgrade').value,
    lastSchoolYearCompleted: document.getElementById('lastschoolyear').value,
    track: document.getElementById('trackInput').value,
    strand: document.getElementById('strandSelect').value,
    enrollmentDate: new Date().toISOString().split('T')[0],
    status: 'Pending',
    documents: {
      form138: document.getElementById('form138-name').textContent || '',
      birthCertificate: document.getElementById('birthCertificate-name').textContent || '',
      goodMoral: document.getElementById('goodMoral-name').textContent || '',
      transferCert: document.getElementById('transferCert-name').textContent || '',
      idPicture: document.getElementById('idPicture-name').textContent || ''
    }
  };
}

function showSuccessModal(formData) {
  const analytics = calculateAnalytics();
  const totalStudents = analytics.academicCount + analytics.techproCount;
  
  const modal = document.createElement('div');
  modal.className = 'modal';
  
  modal.innerHTML = `
    <div class="modal-content">
      <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; color: var(--primary);">üéâ</div>
        <h2 style="color: var(--primary); margin: 1rem 0;">Enrollment Submitted Successfully!</h2>
        <div style="background: var(--gray-100); padding: 1.5rem; border-radius: var(--radius); margin: 1.5rem 0; text-align: left;">
          <h4 style="color: var(--primary); margin-bottom: 0.75rem;">Student Details:</h4>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
            <div><strong>Name:</strong> ${formData.firstName} ${formData.lastName}</div>
            <div><strong>LRN:</strong> ${formData.lrn}</div>
            <div><strong>Track:</strong> ${formData.track}</div>
            <div><strong>Strand:</strong> ${formData.strand}</div>
            <div><strong>Gender:</strong> ${formData.sex}</div>
            <div><strong>Status:</strong> <span class="status-badge ${getStatusClass(formData.status)}">${formData.status}</span></div>
          </div>
        </div>
        
        <!-- Analytics Summary -->
        <div style="background: linear-gradient(135deg, var(--primary), var(--primary-light)); color: white; padding: 1.5rem; border-radius: var(--radius); margin: 1.5rem 0; text-align: left;">
          <h4 style="margin-bottom: 0.75rem; color: white;"><i class="fas fa-chart-line"></i> Enrollment Analytics</h4>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
            <div>
              <div style="font-size: 1.5rem; font-weight: bold;">${analytics.academicCount}</div>
              <div style="font-size: 0.9rem;">Academic Track</div>
            </div>
            <div>
              <div style="font-size: 1.5rem; font-weight: bold;">${analytics.techproCount}</div>
              <div style="font-size: 0.9rem;">Tech-Pro Track</div>
            </div>
            <div>
              <div style="font-size: 1.5rem; font-weight: bold;">${analytics.maleCount}</div>
              <div style="font-size: 0.9rem;">Male Students</div>
            </div>
            <div>
              <div style="font-size: 1.5rem; font-weight: bold;">${analytics.femaleCount}</div>
              <div style="font-size: 0.9rem;">Female Students</div>
            </div>
          </div>
        </div>
        
        <p style="color: var(--gray-700); margin-bottom: 2rem;">
          The student has been added to the system. Total students: <strong>${totalStudents}</strong>
        </p>
        <div style="display: flex; gap: 1rem; justify-content: center;">
          <button onclick="openPage('dashboard', document.querySelector('.nav-tab'))" 
            class="btn btn-primary" style="flex: 1;">
            <i class="fas fa-tachometer-alt"></i> Go to Dashboard
          </button>
          <button onclick="this.closest('.modal').remove()" 
            class="btn btn-secondary" style="flex: 1;">
            <i class="fas fa-check"></i> Close
          </button>
        </div>
      </div>
    </div>
  `;
  
  document.body.appendChild(modal);
}

function resetEnrollmentForm() {
  // Reset to step 1
  goToStep(1);
  
  // Clear all form fields
  const form = document.querySelector('#enrollment form');
  if (form) form.reset();
  
  // Clear file names
  document.querySelectorAll('.file-name').forEach(el => {
    el.textContent = '';
  });
  
  // Reset guardian info
  if (guardianInfoVisible) {
    toggleGuardianInfo();
  }
  
  // Clear track selection
  selectedTrack = '';
  document.getElementById('trackInput').value = '';
  document.getElementById('strandSelect').innerHTML = '<option value="">Select Strand</option>';
}

// ============= FILE UPLOAD HANDLING =============
function setupFileUploads() {
  const fileInputs = document.querySelectorAll('input[type="file"]');
  
  fileInputs.forEach(input => {
    input.addEventListener('change', function(e) {
      const fileName = this.files[0]?.name || 'No file chosen';
      const nameElement = document.getElementById(`${this.id}-name`);
      
      if (nameElement) {
        nameElement.textContent = fileName;
      }
    });
  });
}

// ============= DASHBOARD FUNCTIONS =============
function updateStats() {
  const today = new Date().toISOString().split('T')[0];
  const todayEnrollments = students.filter(s => s.enrollmentDate === today).length;
  const pendingDocuments = students.filter(s => s.status === 'Pending').length;
  const completionRate = students.length > 0 ? Math.round((students.filter(s => s.status === 'Complete').length / students.length) * 100) : 0;
  
  // Update dashboard cards
  const todayEnrollmentsElement = document.getElementById('todayEnrollments');
  const todayEnrollmentsCardElement = document.getElementById('todayEnrollmentsCard');
  const pendingDocsElement = document.getElementById('pendingDocs');
  const pendingDocsCardElement = document.getElementById('pendingDocsCard');
  const totalStudentsElement = document.getElementById('totalStudents');
  const totalStudentsCardElement = document.getElementById('totalStudentsCard');
  const completionRateElement = document.getElementById('completionRate');
  const completionRateCardElement = document.getElementById('completionRateCard');
  
  if (todayEnrollmentsElement) todayEnrollmentsElement.textContent = todayEnrollments;
  if (todayEnrollmentsCardElement) todayEnrollmentsCardElement.textContent = todayEnrollments;
  if (pendingDocsElement) pendingDocsElement.textContent = pendingDocuments;
  if (pendingDocsCardElement) pendingDocsCardElement.textContent = pendingDocuments;
  if (totalStudentsElement) totalStudentsElement.textContent = students.length;
  if (totalStudentsCardElement) totalStudentsCardElement.textContent = students.length;
  if (completionRateElement) completionRateElement.textContent = completionRate + '%';
  if (completionRateCardElement) completionRateCardElement.textContent = completionRate + '%';
  
  // Update document stats
  const pendingReview = document.getElementById('pendingReview');
  const approvedDocs = document.getElementById('approvedDocs');
  const processedDocs = document.getElementById('processedDocs');
  
  if (pendingReview) pendingReview.textContent = pendingDocuments;
  if (approvedDocs) approvedDocs.textContent = students.filter(s => s.status === 'Complete').length;
  if (processedDocs) processedDocs.textContent = students.length;
}

function loadRecentEnrollments() {
  const tbody = document.getElementById('recentEnrollments');
  if (!tbody) return;
  
  tbody.innerHTML = '';
  
  // Get 5 most recent enrollments
  const recent = [...students]
    .sort((a, b) => new Date(b.enrollmentDate) - new Date(a.enrollmentDate))
    .slice(0, 5);
  
  recent.forEach(student => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${student.lrn}</td>
      <td>${student.lastName}, ${student.firstName}</td>
      <td>${student.track}</td>
      <td>${student.strand}</td>
      <td><span class="status-badge ${getStatusClass(student.status)}">${student.status}</span></td>
      <td>${student.enrollmentDate}</td>
    `;
    tbody.appendChild(row);
  });
}

function searchDashboard() {
  const query = document.getElementById('dashboardSearch').value.toLowerCase();
  alert(`Searching for: ${query}\n\nThis feature would search across all data in a full implementation.`);
}

// ============= DASHBOARD CHART FUNCTIONS =============
function initializeDashboardCharts() {
  updateDashboardCharts();
}

function updateDashboardCharts() {
  // Calculate analytics for dashboard
  const analytics = calculateAnalytics();
  
  // Update dashboard track chart
  updateDashboardTrackChart(analytics);
  
  // Update dashboard gender chart
  updateDashboardGenderChart(analytics);
  
  // Update summary text
  updateDashboardSummaries(analytics);
}

function calculateAnalytics() {
  // Calculate track distribution
  const academicCount = students.filter(s => s.track === 'Academic').length;
  const techproCount = students.filter(s => s.track === 'Tech-Pro').length;
  
  // Calculate gender distribution
  const maleCount = students.filter(s => s.sex === 'Male').length;
  const femaleCount = students.filter(s => s.sex === 'Female').length;
  
  // Calculate strand distribution
  const strands = ['STEM', 'ABM', 'HUMSS', 'ICT', 'Home Economics', 'Automotive'];
  const strandCounts = strands.map(strand => 
    students.filter(s => s.strand === strand).length
  );
  
  // Calculate percentages
  const totalStudents = academicCount + techproCount;
  const totalGender = maleCount + femaleCount;
  
  const academicPercent = totalStudents > 0 ? Math.round((academicCount / totalStudents) * 100) : 0;
  const techproPercent = totalStudents > 0 ? Math.round((techproCount / totalStudents) * 100) : 0;
  const malePercent = totalGender > 0 ? Math.round((maleCount / totalGender) * 100) : 0;
  const femalePercent = totalGender > 0 ? Math.round((femaleCount / totalGender) * 100) : 0;
  
  return {
    academicCount, techproCount, academicPercent, techproPercent,
    maleCount, femaleCount, malePercent, femalePercent,
    strandCounts, totalStudents, totalGender
  };
}

function updateDashboardTrackChart(analytics) {
  const ctx = document.getElementById('dashboardTrackChart');
  if (!ctx) return;
  
  // Destroy existing chart if it exists
  if (dashboardTrackChart) {
    dashboardTrackChart.destroy();
  }
  
  dashboardTrackChart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: ['Academic', 'Tech-Pro'],
      datasets: [{
        data: [analytics.academicCount, analytics.techproCount],
        backgroundColor: [
          'rgba(139, 0, 0, 0.8)',  // Academic - Dark Red
          'rgba(0, 100, 0, 0.8)'   // Tech-Pro - Dark Green
        ],
        borderColor: [
          'rgba(139, 0, 0, 1)',
          'rgba(0, 100, 0, 1)'
        ],
        borderWidth: 2,
        hoverOffset: 10
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          display: false
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              const label = context.label || '';
              const value = context.raw || 0;
              const percentage = context.parsed;
              return `${label}: ${value} students (${analytics[label === 'Academic' ? 'academicPercent' : 'techproPercent']}%)`;
            }
          }
        }
      },
      animation: {
        animateScale: true,
        animateRotate: true,
        duration: 800
      }
    }
  });
}

function updateDashboardGenderChart(analytics) {
  const ctx = document.getElementById('dashboardGenderChart');
  if (!ctx) return;
  
  // Destroy existing chart if it exists
  if (dashboardGenderChart) {
    dashboardGenderChart.destroy();
  }
  
  dashboardGenderChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ['Male', 'Female'],
      datasets: [{
        data: [analytics.maleCount, analytics.femaleCount],
        backgroundColor: [
          'rgba(54, 162, 235, 0.8)',  // Male - Blue
          'rgba(255, 99, 132, 0.8)'   // Female - Pink
        ],
        borderColor: [
          'rgba(54, 162, 235, 1)',
          'rgba(255, 99, 132, 1)'
        ],
        borderWidth: 2,
        hoverOffset: 10
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      cutout: '65%',
      plugins: {
        legend: {
          display: false
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              const label = context.label || '';
              const value = context.raw || 0;
              return `${label}: ${value} students (${analytics[label === 'Male' ? 'malePercent' : 'femalePercent']}%)`;
            }
          }
        }
      },
      animation: {
        animateScale: true,
        animateRotate: true,
        duration: 800
      }
    }
  });
}

function updateDashboardSummaries(analytics) {
  // Update track summary
  const trackSummary = document.getElementById('trackSummary');
  if (trackSummary) {
    if (analytics.totalStudents > 0) {
      trackSummary.innerHTML = `
        <div style="display: flex; justify-content: center; gap: 2rem; margin-top: 0.5rem;">
          <div>
            <div style="font-weight: bold; color: var(--primary);">${analytics.academicCount}</div>
            <div style="font-size: 0.8rem;">Academic (${analytics.academicPercent}%)</div>
          </div>
          <div>
            <div style="font-weight: bold; color: var(--primary);">${analytics.techproCount}</div>
            <div style="font-size: 0.8rem;">Tech-Pro (${analytics.techproPercent}%)</div>
          </div>
        </div>
      `;
    } else {
      trackSummary.innerHTML = '<div style="color: var(--gray-500);">No enrollment data available</div>';
    }
  }
  
  // Update gender summary
  const genderSummary = document.getElementById('genderSummary');
  if (genderSummary) {
    if (analytics.totalGender > 0) {
      genderSummary.innerHTML = `
        <div style="display: flex; justify-content: center; gap: 2rem; margin-top: 0.5rem;">
          <div>
            <div style="font-weight: bold; color: var(--primary);">${analytics.maleCount}</div>
            <div style="font-size: 0.8rem;">Male (${analytics.malePercent}%)</div>
          </div>
          <div>
            <div style="font-weight: bold; color: var(--primary);">${analytics.femaleCount}</div>
            <div style="font-size: 0.8rem;">Female (${analytics.femalePercent}%)</div>
          </div>
        </div>
      `;
    } else {
      genderSummary.innerHTML = '<div style="color: var(--gray-500);">No gender data available</div>';
    }
  }
}

// ============= STUDENT LIST FUNCTIONS =============
function loadStudentList() {
  const tbody = document.getElementById('studentList');
  if (!tbody) return;
  
  tbody.innerHTML = '';
  
  if (students.length === 0) {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td colspan="7" style="text-align: center; padding: 2rem; color: var(--gray-700);">
        <div style="font-size: 3rem; margin-bottom: 1rem;">üìö</div>
        <h3 style="color: var(--gray-700); margin-bottom: 0.5rem;">No students enrolled yet</h3>
        <p style="margin-bottom: 1.5rem;">Start by enrolling a new student using the "New Enrollment" button.</p>
        <button onclick="openNewEnrollment()" class="btn btn-primary">
          <i class="fas fa-user-plus"></i> Enroll First Student
        </button>
      </td>
    `;
    tbody.appendChild(row);
    return;
  }
  
  // Sort students by enrollment date (newest first)
  const sortedStudents = [...students].sort((a, b) => {
    return new Date(b.enrollmentDate || 0) - new Date(a.enrollmentDate || 0);
  });
  
  sortedStudents.forEach(student => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${student.lrn}</td>
      <td>${student.lastName}, ${student.firstName} ${student.middleName ? student.middleName.charAt(0) + '.' : ''}</td>
      <td>${student.track}</td>
      <td>${student.strand}</td>
      <td>${student.gradeLevel}</td>
      <td><span class="status-badge ${getStatusClass(student.status)}">${student.status}</span></td>
      <td>
        <div style="display: flex; gap: 0.25rem;">
          <button class="btn btn-secondary btn-sm" onclick="viewStudent(${student.id})" style="padding: 0.25rem 0.5rem; font-size: 0.85rem;">
            <i class="fas fa-eye"></i> View
          </button>
          <button class="btn btn-secondary btn-sm" onclick="editStudent(${student.id})" style="padding: 0.25rem 0.5rem; font-size: 0.85rem;">
            <i class="fas fa-edit"></i> Edit
          </button>
        </div>
      </td>
    `;
    tbody.appendChild(row);
  });
}

function searchStudents() {
  const query = document.getElementById('studentSearch').value.toLowerCase();
  const rows = document.querySelectorAll('#studentList tr');
  
  rows.forEach(row => {
    const text = row.textContent.toLowerCase();
    row.style.display = text.includes(query) ? '' : 'none';
  });
}

function viewStudent(studentId) {
  const student = students.find(s => s.id === studentId);
  if (!student) return;
  
  // Create a detailed view modal
  const modal = document.createElement('div');
  modal.className = 'modal';
  
  modal.innerHTML = `
    <div class="modal-content">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h3 style="color: var(--primary); font-family: 'Poppins', sans-serif;">
          <i class="fas fa-user-graduate"></i> Student Details
        </h3>
        <button onclick="this.closest('.modal').remove()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--gray-700);">&times;</button>
      </div>
      
      <div style="background: var(--gray-100); padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
          <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--primary), var(--primary-light)); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
            ${student.firstName.charAt(0)}${student.lastName.charAt(0)}
          </div>
          <div>
            <h4 style="color: var(--primary); margin-bottom: 0.25rem;">${student.firstName} ${student.lastName}</h4>
            <p style="color: var(--gray-700); font-size: 0.9rem;">LRN: ${student.lrn}</p>
            <p style="color: var(--gray-700); font-size: 0.9rem;">Status: <span class="status-badge ${getStatusClass(student.status)}">${student.status}</span></p>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
          <div>
            <strong>Track:</strong> ${student.track}
          </div>
          <div>
            <strong>Strand:</strong> ${student.strand}
          </div>
          <div>
            <strong>Grade Level:</strong> ${student.gradeLevel}
          </div>
          <div>
            <strong>Gender:</strong> ${student.sex}
          </div>
          <div>
            <strong>Age:</strong> ${student.age}
          </div>
          <div>
            <strong>Enrollment Date:</strong> ${student.enrollmentDate}
          </div>
        </div>
      </div>
      
      <div style="display: flex; gap: 1rem; justify-content: flex-end;">
        <button onclick="editStudent(${student.id}); this.closest('.modal').remove()" class="btn btn-primary">
          <i class="fas fa-edit"></i> Edit Student
        </button>
        <button onclick="this.closest('.modal').remove()" class="btn btn-secondary">
          Close
        </button>
      </div>
    </div>
  `;
  
  document.body.appendChild(modal);
}

function editStudent(studentId) {
  const student = students.find(s => s.id === studentId);
  if (!student) return;
  
  alert(`Edit Student: ${student.firstName} ${student.lastName}\n\nThis would open an edit form in a full implementation.\n\nYou can edit student information and update the records.`);
}

// ============= DOCUMENT FUNCTIONS =============
function loadDocumentList() {
  const tbody = document.getElementById('documentList');
  if (!tbody) return;
  
  tbody.innerHTML = '';
  
  // Sample document data
  const sampleDocs = [
    { student: 'Juan Dela Cruz', type: 'Report Card', date: '2024-03-15', status: 'Pending' },
    { student: 'Ana Santos', type: 'Birth Certificate', date: '2024-03-14', status: 'Approved' },
    { student: 'Miguel Reyes', type: 'Good Moral', date: '2024-03-13', status: 'Pending' },
    { student: 'Maria Gonzales', type: 'Transfer Certificate', date: '2024-03-12', status: 'Rejected' },
  ];
  
  sampleDocs.forEach(doc => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${doc.student}</td>
      <td>${doc.type}</td>
      <td>${doc.date}</td>
      <td><span class="status-badge ${getStatusClass(doc.status)}">${doc.status}</span></td>
      <td>
        <button class="btn btn-secondary btn-sm" style="padding: 0.25rem 0.5rem; font-size: 0.85rem;">
          <i class="fas fa-download"></i> Download
        </button>
      </td>
    `;
    tbody.appendChild(row);
  });
}

// ============= ANALYTICS & CHART FUNCTIONS =============
function updateAnalytics() {
  // Calculate track distribution
  const academicCount = students.filter(s => s.track === 'Academic').length;
  const techproCount = students.filter(s => s.track === 'Tech-Pro').length;
  
  // Calculate gender distribution
  const maleCount = students.filter(s => s.sex === 'Male').length;
  const femaleCount = students.filter(s => s.sex === 'Female').length;
  
  // Update counters
  const academicCountElement = document.getElementById('academicCount');
  const techproCountElement = document.getElementById('techproCount');
  const maleCountElement = document.getElementById('maleCount');
  const femaleCountElement = document.getElementById('femaleCount');
  
  if (academicCountElement) academicCountElement.textContent = academicCount;
  if (techproCountElement) techproCountElement.textContent = techproCount;
  if (maleCountElement) maleCountElement.textContent = maleCount;
  if (femaleCountElement) femaleCountElement.textContent = femaleCount;
  
  return { academicCount, techproCount, maleCount, femaleCount };
}

function initializeCharts() {
  const analytics = updateAnalytics();
  
  // Destroy existing charts if they exist
  if (trackChart) trackChart.destroy();
  if (genderChart) genderChart.destroy();
  if (strandChart) strandChart.destroy();
  if (trendChart) trendChart.destroy();
  
  // Track Distribution Pie Chart
  const trackCtx = document.getElementById('trackChart');
  if (trackCtx) {
    trackChart = new Chart(trackCtx, {
      type: 'pie',
      data: {
        labels: ['Academic Track', 'Tech-Pro Track'],
        datasets: [{
          data: [analytics.academicCount, analytics.techproCount],
          backgroundColor: [
            'rgba(139, 0, 0, 0.8)',  // Academic - Dark Red
            'rgba(0, 100, 0, 0.8)'   // Tech-Pro - Dark Green
          ],
          borderColor: [
            'rgba(139, 0, 0, 1)',
            'rgba(0, 100, 0, 1)'
          ],
          borderWidth: 2,
          hoverOffset: 15
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              padding: 20,
              usePointStyle: true,
              font: {
                family: 'Poppins',
                size: 12
              }
            }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const label = context.label || '';
                const value = context.raw || 0;
                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                const percentage = total > 0 ? Math.round((value / total) * 100) : 0;
                return `${label}: ${value} students (${percentage}%)`;
              }
            }
          }
        },
        animation: {
          animateScale: true,
          animateRotate: true
        }
      }
    });
  }
  
  // Gender Distribution Doughnut Chart
  const genderCtx = document.getElementById('genderChart');
  if (genderCtx) {
    genderChart = new Chart(genderCtx, {
      type: 'doughnut',
      data: {
        labels: ['Male', 'Female'],
        datasets: [{
          data: [analytics.maleCount, analytics.femaleCount],
          backgroundColor: [
            'rgba(54, 162, 235, 0.8)',  // Male - Blue
            'rgba(255, 99, 132, 0.8)'   // Female - Pink
          ],
          borderColor: [
            'rgba(54, 162, 235, 1)',
            'rgba(255, 99, 132, 1)'
          ],
          borderWidth: 2,
          hoverOffset: 15
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '70%',
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              padding: 20,
              usePointStyle: true,
              font: {
                family: 'Poppins',
                size: 12
              }
            }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const label = context.label || '';
                const value = context.raw || 0;
                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                const percentage = total > 0 ? Math.round((value / total) * 100) : 0;
                return `${label}: ${value} students (${percentage}%)`;
              }
            }
          }
        },
        animation: {
          animateScale: true,
          animateRotate: true
        }
      }
    });
  }
  
  // Strand Distribution Bar Chart
  const strandCtx = document.getElementById('strandChart');
  if (strandCtx) {
    const strands = ['STEM', 'ABM', 'HUMSS', 'ICT', 'Home Economics', 'Automotive'];
    const strandCounts = strands.map(strand => 
      students.filter(s => s.strand === strand).length
    );
    
    strandChart = new Chart(strandCtx, {
      type: 'bar',
      data: {
        labels: strands,
        datasets: [{
          label: 'Number of Students',
          data: strandCounts,
          backgroundColor: [
            'rgba(139, 0, 0, 0.7)',   // STEM
            'rgba(165, 42, 42, 0.7)', // ABM
            'rgba(178, 34, 34, 0.7)', // HUMSS
            'rgba(0, 100, 0, 0.7)',   // ICT
            'rgba(34, 139, 34, 0.7)', // Home Economics
            'rgba(60, 179, 113, 0.7)' // Automotive
          ],
          borderColor: [
            'rgba(139, 0, 0, 1)',
            'rgba(165, 42, 42, 1)',
            'rgba(178, 34, 34, 1)',
            'rgba(0, 100, 0, 1)',
            'rgba(34, 139, 34, 1)',
            'rgba(60, 179, 113, 1)'
          ],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Number of Students'
            }
          },
          x: {
            title: {
              display: true,
              text: 'Strand'
            }
          }
        }
      }
    });
  }
  
  // Enrollment Trend Line Chart
  const trendCtx = document.getElementById('trendChart');
  if (trendCtx) {
    // Generate sample monthly data
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    const monthlyEnrollments = months.map((month, index) => {
      const monthNum = index + 1;
      return students.filter(s => {
        if (s.enrollmentDate) {
          const date = new Date(s.enrollmentDate);
          return date.getMonth() + 1 === monthNum;
        }
        return false;
      }).length;
    });
    
    // Add current month enrollment if not enough data
    if (monthlyEnrollments.reduce((a, b) => a + b, 0) === 0) {
      const currentMonth = new Date().getMonth();
      monthlyEnrollments[currentMonth] = students.length || 5;
    }
    
    trendChart = new Chart(trendCtx, {
      type: 'line',
      data: {
        labels: months,
        datasets: [{
          label: 'Enrollments',
          data: monthlyEnrollments,
          backgroundColor: 'rgba(139, 0, 0, 0.1)',
          borderColor: 'rgba(139, 0, 0, 1)',
          borderWidth: 3,
          tension: 0.4,
          fill: true,
          pointBackgroundColor: 'rgba(139, 0, 0, 1)',
          pointBorderColor: '#fff',
          pointBorderWidth: 2,
          pointRadius: 5,
          pointHoverRadius: 8
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Number of Enrollments'
            }
          },
          x: {
            title: {
              display: true,
              text: 'Month'
            }
          }
        }
      }
    });
  }
}

function refreshCharts() {
  initializeCharts();
  alert('Analytics charts refreshed with latest data!');
}

// ============= REPORT FUNCTIONS =============
function generateReport() {
  const type = document.getElementById('reportType').value;
  const year = document.getElementById('reportYear').value;
  const format = document.getElementById('reportFormat').value;
  
  alert(`Generating ${type} report for ${year} in ${format} format...\n\nThis would generate and download the report in a full implementation.`);
}

function viewReportHistory() {
  alert('This would show a list of previously generated reports.');
}

function configureReports() {
  alert('This would open report configuration settings.');
}

function clearReportFilters() {
  document.getElementById('reportType').selectedIndex = 0;
  document.getElementById('reportYear').selectedIndex = 0;
  document.getElementById('reportFormat').selectedIndex = 0;
}

// ============= UTILITY FUNCTIONS =============
function getStatusClass(status) {
  switch(status.toLowerCase()) {
    case 'pending': return 'status-pending';
    case 'complete': case 'approved': return 'status-complete';
    case 'rejected': case 'incomplete': return 'status-rejected';
    default: return 'status-pending';
  }
}

function loadSampleData() {
  // Load sample students if none exist
  if (students.length === 0) {
    students = [
      {
        id: 1,
        lrn: "123456789012",
        lastName: "Dela Cruz",
        firstName: "Juan",
        middleName: "Santos",
        sex: "Male",
        age: 16,
        dob: "2007-05-15",
        placeOfBirth: "Manila",
        motherTongue: "Tagalog",
        currentAddress: "123 Main St, Manila",
        permanentAddress: "123 Main St, Manila",
        fatherName: "Juan Dela Cruz Sr.",
        fatherContact: "09123456789",
        motherName: "Maria Dela Cruz",
        motherContact: "09198765432",
        schoolYear: "2024-2025",
        gradeLevel: "Grade 11",
        lastGradeCompleted: "Grade 10",
        lastSchoolYearCompleted: "2023-2024",
        track: "Academic",
        strand: "STEM",
        enrollmentDate: "2024-03-15",
        status: "Complete"
      },
      {
        id: 2,
        lrn: "987654321098",
        lastName: "Santos",
        firstName: "Ana",
        middleName: "Reyes",
        sex: "Female",
        age: 17,
        dob: "2006-08-22",
        placeOfBirth: "Quezon City",
        motherTongue: "Tagalog",
        currentAddress: "456 Elm St, Quezon City",
        permanentAddress: "456 Elm St, Quezon City",
        fatherName: "Carlos Santos",
        fatherContact: "09234567890",
        motherName: "Elena Santos",
        motherContact: "09287654321",
        schoolYear: "2024-2025",
        gradeLevel: "Grade 12",
        lastGradeCompleted: "Grade 11",
        lastSchoolYearCompleted: "2023-2024",
        track: "Tech-Pro",
        strand: "ICT",
        enrollmentDate: "2024-03-14",
        status: "Pending"
      },
      {
        id: 3,
        lrn: "567890123456",
        lastName: "Reyes",
        firstName: "Miguel",
        middleName: "Cruz",
        sex: "Male",
        age: 17,
        dob: "2006-11-10",
        placeOfBirth: "Cebu City",
        motherTongue: "Cebuano",
        currentAddress: "789 Oak St, Cebu City",
        permanentAddress: "789 Oak St, Cebu City",
        fatherName: "Pedro Reyes",
        fatherContact: "09345678901",
        motherName: "Sofia Reyes",
        motherContact: "09376543210",
        schoolYear: "2024-2025",
        gradeLevel: "Grade 11",
        lastGradeCompleted: "Grade 10",
        lastSchoolYearCompleted: "2023-2024",
        track: "Academic",
        strand: "ABM",
        enrollmentDate: "2024-03-10",
        status: "Complete"
      },
      {
        id: 4,
        lrn: "345678901234",
        lastName: "Gonzales",
        firstName: "Maria",
        middleName: "Luna",
        sex: "Female",
        age: 16,
        dob: "2007-02-28",
        placeOfBirth: "Davao City",
        motherTongue: "Tagalog",
        currentAddress: "321 Pine St, Davao City",
        permanentAddress: "321 Pine St, Davao City",
        fatherName: "Antonio Gonzales",
        fatherContact: "09456789012",
        motherName: "Carmen Gonzales",
        motherContact: "09465432109",
        schoolYear: "2024-2025",
        gradeLevel: "Grade 11",
        lastGradeCompleted: "Grade 10",
        lastSchoolYearCompleted: "2023-2024",
        track: "Academic",
        strand: "HUMSS",
        enrollmentDate: "2024-03-05",
        status: "Pending"
      },
      {
        id: 5,
        lrn: "456789012345",
        lastName: "Tan",
        firstName: "Michael",
        middleName: "Lim",
        sex: "Male",
        age: 17,
        dob: "2006-09-18",
        placeOfBirth: "Makati",
        motherTongue: "English",
        currentAddress: "555 Maple St, Makati",
        permanentAddress: "555 Maple St, Makati",
        fatherName: "Robert Tan",
        fatherContact: "09567890123",
        motherName: "Elizabeth Tan",
        motherContact: "09554321098",
        schoolYear: "2024-2025",
        gradeLevel: "Grade 12",
        lastGradeCompleted: "Grade 11",
        lastSchoolYearCompleted: "2023-2024",
        track: "Tech-Pro",
        strand: "Home Economics",
        enrollmentDate: "2024-03-03",
        status: "Complete"
      },
      {
        id: 6,
        lrn: "678901234567",
        lastName: "Chen",
        firstName: "Sophia",
        middleName: "Wong",
        sex: "Female",
        age: 16,
        dob: "2007-04-22",
        placeOfBirth: "Binondo",
        motherTongue: "Chinese",
        currentAddress: "777 Cedar St, Binondo",
        permanentAddress: "777 Cedar St, Binondo",
        fatherName: "David Chen",
        fatherContact: "09678901234",
        motherName: "Mei Chen",
        motherContact: "09643210987",
        schoolYear: "2024-2025",
        gradeLevel: "Grade 11",
        lastGradeCompleted: "Grade 10",
        lastSchoolYearCompleted: "2023-2024",
        track: "Tech-Pro",
        strand: "Automotive",
        enrollmentDate: "2024-03-01",
        status: "Pending"
      }
    ];
  }
}

</script>

</body>
</html>